# AIChat - å…¨æ–¹ä½ LLM å‘½ä»¤åˆ—å·¥å…·

## å°ˆæ¡ˆç°¡ä»‹

AIChat æ˜¯ä¸€å€‹ä½¿ç”¨ Rust é–‹ç™¼çš„å…¨åŠŸèƒ½ AI åŠ©æ‰‹å‘½ä»¤åˆ—å·¥å…·,æä¾›çµ±ä¸€ä»‹é¢æ•´åˆè¶…é 20 å€‹ä¸»æµ LLM æœå‹™æä¾›å•†ã€‚ç„¡è«–æ˜¯æ—¥å¸¸å°è©±ã€ç¨‹å¼é–‹ç™¼ã€Shell æ“ä½œé‚„æ˜¯æ–‡ä»¶å•ç­”,AIChat éƒ½èƒ½æä¾›å¼·å¤§çš„æ”¯æ´ã€‚

**å°ˆæ¡ˆè³‡è¨Š:**
- ç‰ˆæœ¬: 0.30.0
- æˆæ¬Š: MIT OR Apache-2.0
- å€‰åº«: https://github.com/sigoden/aichat (upstream)
- Fork: LASP Final Project - Group 12
- èªè¨€: Rust
- å¹³å°: macOS, Linux, Windows, Android Termux

## ğŸ†• æ–°å¢åŠŸèƒ½ (LASP Final Project)

æœ¬ fork æ–°å¢äº†ä¸‰å€‹ä¸»è¦åŠŸèƒ½,æ—¨åœ¨æå‡ AIChat çš„å®‰å…¨æ€§ã€ç’°å¢ƒé©æ‡‰æ€§å’Œå”ä½œèƒ½åŠ›:

### 1. âœ… ç’°å¢ƒè‡ªå‹•åµæ¸¬ (Auto-Setup / Environment Awareness)
**ç‹€æ…‹:** å·²å®Œå…¨å¯¦ç¾

AIChat ç¾åœ¨æœƒè‡ªå‹•åµæ¸¬ä¸¦é©æ‡‰æ‚¨çš„ç³»çµ±ç’°å¢ƒ,ç¢ºä¿æ‰€æœ‰ AI ç”Ÿæˆçš„å‘½ä»¤å’Œå»ºè­°éƒ½ç¬¦åˆæ‚¨çš„ä½œæ¥­ç³»çµ±å’Œå·¥å…·éˆã€‚

**åŠŸèƒ½ç‰¹é»:**
- ğŸ–¥ï¸ **ä½œæ¥­ç³»çµ±åµæ¸¬**: è‡ªå‹•è­˜åˆ¥ macOS, Linux, Windows, WSL
- ğŸš **Shell é¡å‹åµæ¸¬**: æ”¯æ´ Bash, Zsh, Fish, PowerShell, Cmd
- ğŸ“¦ **å¥—ä»¶ç®¡ç†å™¨åµæ¸¬**: è­˜åˆ¥ Brew, Apt, Pacman, Nix, Choco, Scoop, Winget
- ğŸ’» **ç³»çµ±è³‡è¨Šæ”¶é›†**: CPU æ ¸å¿ƒæ•¸ã€è¨˜æ†¶é«”å®¹é‡ã€ç¡¬ç¢Ÿç©ºé–“ã€GPU å‹è™Ÿ
- ğŸ¤– **AI ç’°å¢ƒæ„ŸçŸ¥**: å°‡ç’°å¢ƒè³‡è¨Šè‡ªå‹•æ³¨å…¥ AI prompt,ç¢ºä¿å»ºè­°çš„å‘½ä»¤èˆ‡æ‚¨çš„ç³»çµ±ç›¸å®¹

**ä½¿ç”¨ç¯„ä¾‹:**
```bash
# åœ¨ macOS ä¸ŠåŸ·è¡Œ
aichat -c "å®‰è£ Python"
# AI æœƒå»ºè­°: brew install python (è€Œé apt install python)

# åœ¨ Ubuntu ä¸ŠåŸ·è¡Œç›¸åŒæŒ‡ä»¤
aichat -c "å®‰è£ Python"
# AI æœƒå»ºè­°: sudo apt install python3
```

**æŠ€è¡“å¯¦ç¾:**
- æ–°å¢ `src/config/environments.rs` æ¨¡çµ„
- ç’°å¢ƒè³‡è¨Šä»¥ XML æ ¼å¼æ³¨å…¥æ‰€æœ‰ role prompts
- åœ¨ `.info` å‘½ä»¤ä¸­å¯æŸ¥çœ‹åµæ¸¬åˆ°çš„ç’°å¢ƒè³‡è¨Š

### 2. âœ… Session åŒ¯å‡ºç‚º Markdown (Session Export)
**ç‹€æ…‹:** å·²å®Œå…¨å¯¦ç¾

å°‡ REPL å°è©± session åŒ¯å‡ºç‚ºæ ¼å¼åŒ–çš„ Markdown æ–‡ä»¶,æ–¹ä¾¿åˆ†äº«ã€å­˜æª”æˆ–æäº¤ä½œæ¥­ã€‚

**åŠŸèƒ½ç‰¹é»:**
- ğŸ“„ **å®Œæ•´å°è©±è¨˜éŒ„**: ä¿ç•™æ‰€æœ‰æå•å’Œå›æ‡‰
- ğŸ¨ **Markdown æ ¼å¼åŒ–**: è‡ªå‹•æ ¼å¼åŒ–ç¨‹å¼ç¢¼å€å¡Šå’Œèªæ³•é«˜äº®
- ğŸ’¾ **è‡ªè¨‚æª”å**: æ”¯æ´æŒ‡å®šè¼¸å‡ºæª”å
- ğŸ“Š **åŒ…å«å…ƒè³‡æ–™**: ä¿ç•™ session åç¨±å’Œè¨­å®šè³‡è¨Š

**ä½¿ç”¨æ–¹æ³•:**
```bash
# å•Ÿå‹• REPL ä¸¦å»ºç«‹ session
aichat
> .session my-project
> å¯«ä¸€å€‹æ’åºæ¼”ç®—æ³•
> è§£é‡‹æ™‚é–“è¤‡é›œåº¦
> .export                      # åŒ¯å‡ºç‚º session-my-project.md
> .export my-notes.md          # åŒ¯å‡ºç‚ºè‡ªè¨‚æª”å
```

**å¯¦ç¾ä½ç½®:**
- æ–°å¢ `.export` REPL å‘½ä»¤
- å¯¦ç¾æ–¼ `src/repl/mod.rs` ä¸­çš„ `export_session_markdown()` å‡½æ•¸

### 3. â³ å®‰å…¨åŸ·è¡Œæ¨¡å¼ (Safe and Reversible Execution)
**ç‹€æ…‹:** éƒ¨åˆ†å¯¦ç¾ (ç’°å¢ƒæ„ŸçŸ¥å·²å®Œæˆ)

**å·²å¯¦ç¾:**
- âœ… ç’°å¢ƒæ„ŸçŸ¥ç¢ºä¿ç”Ÿæˆçš„å‘½ä»¤ç¬¦åˆç•¶å‰ç³»çµ±

**è¦åŠƒä¸­ (æœªä¾†å¯¦ä½œ):**
- ğŸ”„ Sandbox é è¦½: åŸ·è¡Œå‰é¡¯ç¤ºå‘½ä»¤é è¦½å’Œè®Šæ›´å·®ç•°
- ğŸ’¾ è‡ªå‹•å‚™ä»½: æª”æ¡ˆæ“ä½œå‰è‡ªå‹•å»ºç«‹å‚™ä»½
- â®ï¸ ä¸€éµå¾©åŸ: æä¾›é¡ä¼¼ git stash çš„å›å¾©åŠŸèƒ½
- ğŸ“– Command Tutor æ¨¡å¼: é€æ­¥è§£é‡‹ç®¡é“å’Œåƒæ•¸,å¼•ç”¨ man page

---

---

## æ ¸å¿ƒåŠŸèƒ½ä¸€è¦½

### 1. å¤š LLM æä¾›å•†æ”¯æ´

AIChat æ•´åˆäº†è¶…é 20 å€‹ä¸»æµ AI æœå‹™æä¾›å•†,é€éçµ±ä¸€çš„ä»‹é¢å³å¯ä½¿ç”¨:

**ä¸»æµé›²ç«¯æœå‹™:**
- **OpenAI** - GPT-4o, GPT-4, GPT-3.5 ç­‰ç³»åˆ—æ¨¡å‹
- **Anthropic Claude** - Claude 3.5 Sonnet, Claude 3 ç³»åˆ—
- **Google Gemini** - Gemini Pro, Gemini Ultra
- **Azure OpenAI** - Microsoft Azure ä¸Šçš„ OpenAI æœå‹™
- **Google VertexAI** - Google Cloud çš„ AI å¹³å°
- **AWS Bedrock** - Amazon çš„ AI æ¨¡å‹æœå‹™

**å…¶ä»–æä¾›å•†:**
- Groq - è¶…é«˜é€Ÿæ¨ç†
- Mistral AI - æ­æ´²é–‹æºæ¨¡å‹
- Deepseek - æ·±åº¦æ±‚ç´¢
- Cohere - ä¼æ¥­ç´š NLP
- Perplexity - æœå°‹å¢å¼·
- Cloudflare Workers AI
- OpenRouter - å¤šæ¨¡å‹èšåˆ
- XAI Grok - X å¹³å° AI
- AI21 Labs
- é˜¿é‡Œé›²é€šç¾©åƒå•
- æ™ºè­œ AI
- æœˆä¹‹æš—é¢ Moonshot
- MiniMax
- ç™¾åº¦æ–‡å¿ƒä¸€è¨€

**æœ¬åœ°æ¨¡å‹:**
- **Ollama** - æœ¬åœ°é‹è¡Œé–‹æºæ¨¡å‹
- ä»»ä½• OpenAI ç›¸å®¹çš„ API

**é…ç½®ç¯„ä¾‹:**
```yaml
clients:
  - type: openai
    api_key: sk-xxx

  - type: claude
    api_key: sk-ant-xxx

  - type: openai-compatible
    name: ollama
    api_base: http://localhost:11434/v1
```

---

### 2. ä¸‰ç¨®å·¥ä½œæ¨¡å¼

#### 2.1 CMD æ¨¡å¼ (å‘½ä»¤åˆ—æ¨¡å¼)

ç›´æ¥åœ¨å‘½ä»¤åˆ—åŸ·è¡Œå–®æ¬¡ AI å°è©±,é©åˆå¿«é€ŸæŸ¥è©¢å’Œè…³æœ¬æ•´åˆã€‚

**åŸºæœ¬ç”¨æ³•:**
```bash
# ç›´æ¥æå•
aichat "è§£é‡‹ä»€éº¼æ˜¯éè¿´"

# å¾æ¨™æº–è¼¸å…¥è®€å–
cat error.log | aichat "åˆ†æé€™å€‹éŒ¯èª¤æ—¥èªŒ"

# æŒ‡å®šæ¨¡å‹
aichat -m claude:claude-3-5-sonnet "å¯«ä¸€å€‹æ’åºç®—æ³•"

# åŒ…å«æª”æ¡ˆ
aichat -f main.py "é€™æ®µç¨‹å¼ç¢¼æœ‰ä»€éº¼å•é¡Œ?"
```

**é€²éšåŠŸèƒ½:**
```bash
# ä½¿ç”¨è§’è‰²
aichat -r code "å¯«ä¸€å€‹ HTTP ä¼ºæœå™¨"

# é–‹å•Ÿæœƒè©±
aichat -s project "ç¹¼çºŒè¨è«–æ¶æ§‹è¨­è¨ˆ"

# ä¹¾é‹è¡Œ(ä¸å¯¦éš›ç™¼é€è«‹æ±‚)
aichat --dry-run "æ¸¬è©¦æç¤ºè©"
```

#### 2.2 REPL æ¨¡å¼ (äº’å‹•å¼å°è©±)

é€²å…¥äº’å‹•å¼èŠå¤©ä»‹é¢,æä¾›è±å¯Œçš„ç·¨è¼¯å’Œå°è©±åŠŸèƒ½ã€‚

**å•Ÿå‹•æ–¹å¼:**
```bash
# ç›´æ¥å•Ÿå‹•
aichat

# æŒ‡å®šé è¨­è¨­å®š
aichat -m gpt-4o -r assistant
```

**REPL ç‰¹è‰²åŠŸèƒ½:**

1. **æ™ºæ…§è£œå…¨**
   - Tab éµè‡ªå‹•è£œå…¨å‘½ä»¤
   - æ”¯æ´æª”æ¡ˆè·¯å¾‘è£œå…¨
   - æ­·å²å‘½ä»¤è£œå…¨

2. **å¤šè¡Œè¼¸å…¥**
   - æ”¯æ´è¤‡é›œçš„å¤šè¡Œå•é¡Œ
   - ç¨‹å¼ç¢¼å€å¡Šå‹å¥½

3. **æ­·å²æœå°‹**
   - Ctrl+R æœå°‹æ­·å²
   - ä¸Šä¸‹éµç€è¦½æ­·å²

4. **è‡ªè¨‚æŒ‰éµç¶å®š**
   ```yaml
   keybindings: emacs  # æˆ– vi
   ```

5. **èªæ³•é«˜äº®**
   - Markdown èªæ³•é«˜äº®
   - ç¨‹å¼ç¢¼å€å¡Šé«˜äº®
   - æ”¯æ´è‡ªè¨‚ä¸»é¡Œ

**REPL å…§å»ºå‘½ä»¤:**
```bash
.help              # é¡¯ç¤ºå¹«åŠ©
.info              # é¡¯ç¤ºç³»çµ±è³‡è¨Š
.model gpt-4o      # åˆ‡æ›æ¨¡å‹
.role code         # åˆ‡æ›è§’è‰²
.session new       # æ–°å»ºæœƒè©±
.session save      # å„²å­˜æœƒè©±
.clear             # æ¸…ç©ºå°è©±
.copy              # è¤‡è£½æœ€å¾Œå›è¦†
.file data.txt     # è¼‰å…¥æª”æ¡ˆ
.exit              # é€€å‡º
```

#### 2.3 Serve æ¨¡å¼ (ä¼ºæœå™¨æ¨¡å¼)

å•Ÿå‹•æœ¬åœ° HTTP ä¼ºæœå™¨,æä¾› API æœå‹™å’Œç¶²é ä»‹é¢ã€‚

**å•Ÿå‹•ä¼ºæœå™¨:**
```bash
# ä½¿ç”¨é è¨­ä½å€ 127.0.0.1:8000
aichat --serve

# æŒ‡å®šä½å€
aichat --serve 0.0.0.0:3000
```

**æä¾›çš„æœå‹™:**

1. **Chat Completions API** - `http://127.0.0.1:8000/v1/chat/completions`
   - OpenAI ç›¸å®¹çš„å°è©± API
   - æ”¯æ´ä¸²æµå›æ‡‰
   - æ”¯æ´å¤šæ¨¡å‹åˆ‡æ›

2. **Embeddings API** - `http://127.0.0.1:8000/v1/embeddings`
   - æ–‡å­—å‘é‡åŒ–æœå‹™
   - æ”¯æ´å¤šç¨® embedding æ¨¡å‹

3. **Rerank API** - `http://127.0.0.1:8000/v1/rerank`
   - æ–‡ä»¶é‡æ–°æ’åºæœå‹™
   - æå‡æª¢ç´¢ç²¾åº¦

4. **LLM Playground** - `http://127.0.0.1:8000/playground`
   - ç¶²é ç‰ˆ AI å°è©±ä»‹é¢
   - è¦–è¦ºåŒ–åƒæ•¸èª¿æ•´
   - å³æ™‚æ¸¬è©¦ä¸åŒæ¨¡å‹

5. **LLM Arena** - `http://127.0.0.1:8000/arena?num=2`
   - å¤šæ¨¡å‹ä¸¦æ’æ¯”è¼ƒ
   - æ”¯æ´ç›²æ¸¬
   - å°æ¯”ä¸åŒæ¨¡å‹çš„å›ç­”

**API ä½¿ç”¨ç¯„ä¾‹:**
```bash
curl -X POST http://127.0.0.1:8000/v1/chat/completions \
  -H "Content-Type: application/json" \
  -d '{
    "model": "gpt-4o",
    "messages": [{"role": "user", "content": "Hello!"}],
    "stream": true
  }'
```

---

### 3. Shell åŠ©æ‰‹

å°‡è‡ªç„¶èªè¨€è½‰æ›ç‚º Shell å‘½ä»¤,å¤§å¹…æå‡å‘½ä»¤åˆ—æ“ä½œæ•ˆç‡ã€‚

**åŸºæœ¬ç”¨æ³•:**
```bash
# ç”Ÿæˆå‘½ä»¤(ä¸åŸ·è¡Œ)
aichat -c "åˆ—å‡ºæ‰€æœ‰å¤§æ–¼ 100MB çš„æª”æ¡ˆ"

# ç”Ÿæˆä¸¦åŸ·è¡Œå‘½ä»¤
aichat -e "æ‰¾å‡ºä½”ç”¨ CPU æœ€é«˜çš„å‰ 5 å€‹ç¨‹åº"
```

**æ™ºæ…§é©æ‡‰:**
- è‡ªå‹•åµæ¸¬ä½œæ¥­ç³»çµ±(Linux/macOS/Windows)
- è‡ªå‹•é©æ‡‰ Shell é¡å‹(bash/zsh/fish/powershell)
- ç”Ÿæˆç›¸å®¹ç•¶å‰ç’°å¢ƒçš„å‘½ä»¤

**ä½¿ç”¨å ´æ™¯:**
```bash
# æª”æ¡ˆæ“ä½œ
aichat -e "å°‡æ‰€æœ‰ jpg è½‰æ›ç‚º png"

# ç³»çµ±ç›£æ§
aichat -e "é¡¯ç¤ºè¨˜æ†¶é«”ä½¿ç”¨ç‡"

# Git æ“ä½œ
aichat -c "å»ºç«‹æ–°åˆ†æ”¯ä¸¦åˆ‡æ›"

# ç¶²è·¯æ“ä½œ
aichat -e "æ¸¬è©¦ç¶²è·¯é€£ç·šé€Ÿåº¦"

# æ–‡å­—è™•ç†
aichat -e "çµ±è¨ˆç¨‹å¼ç¢¼è¡Œæ•¸,æŒ‰èªè¨€åˆ†é¡"
```

**å®‰å…¨ç‰¹æ€§:**
- é è¨­ä¸è‡ªå‹•åŸ·è¡Œ,éœ€åŠ  `-e` åƒæ•¸
- é¡¯ç¤ºå‘½ä»¤ä¾›ä½¿ç”¨è€…ç¢ºèª
- å¯è¨­å®šéœ€è¦äº’å‹•ç¢ºèª

---

### 4. å¤šå½¢å¼è¼¸å…¥æ”¯æ´

AIChat æ”¯æ´å¤šç¨®éˆæ´»çš„è¼¸å…¥æ–¹å¼,å¯ä»¥çµ„åˆä½¿ç”¨ã€‚

#### 4.1 å‘½ä»¤åˆ—åƒæ•¸
```bash
aichat "é€™æ˜¯æˆ‘çš„å•é¡Œ"
```

#### 4.2 æ¨™æº–è¼¸å…¥(STDIN)
```bash
# ç®¡é“è¼¸å…¥
echo "åˆ†æé€™æ®µæ–‡å­—" | aichat

# æ–‡ä»¶é‡å°å‘
aichat < input.txt

# å‘½ä»¤è¼¸å‡º
git diff | aichat "è§£é‡‹é€™äº›è®Šæ›´"
```

#### 4.3 æœ¬åœ°æª”æ¡ˆ
```bash
# å–®å€‹æª”æ¡ˆ
aichat -f README.md "ç¸½çµé€™ä»½æ–‡ä»¶"

# å¤šå€‹æª”æ¡ˆ
aichat -f main.py -f utils.py "é‡æ§‹é€™äº›ç¨‹å¼ç¢¼"

# åœ–ç‰‡(Vision æ¨¡å‹)
aichat -f screenshot.png "æè¿°é€™å¼µåœ–ç‰‡"
```

#### 4.4 æœ¬åœ°ç›®éŒ„
```bash
# è¼‰å…¥æ•´å€‹ç›®éŒ„
aichat -f src/ "åˆ†æå°ˆæ¡ˆçµæ§‹"

# è‡ªå‹•éæ­·å­ç›®éŒ„
aichat -f . "æ‰¾å‡ºæ‰€æœ‰ TODO è¨»è§£"
```

#### 4.5 é ç«¯ URL
```bash
# ç¶²é å…§å®¹
aichat -f https://example.com "ç¸½çµé€™å€‹ç¶²é "

# ç·šä¸Šæ–‡ä»¶
aichat -f https://docs.python.org/3/tutorial/ "è§£é‡‹æ•™å­¸å…§å®¹"
```

#### 4.6 å¤–éƒ¨å‘½ä»¤è¼¸å‡º
```bash
# ä½¿ç”¨åå¼•è™Ÿ
aichat -f '`git log --oneline -10`' "åˆ†ææœ€è¿‘çš„æäº¤"

# çµ„åˆä½¿ç”¨
aichat -f '`ls -la`' "æ¸…ç†ä¸éœ€è¦çš„æª”æ¡ˆ"
```

#### 4.7 çµ„åˆè¼¸å…¥
```bash
# æª”æ¡ˆ + å•é¡Œ
aichat -f data.json -f schema.sql "é©—è­‰è³‡æ–™çµæ§‹"

# å¤šç¨®ä¾†æº
cat error.log | aichat -f config.yaml "è¨ºæ–·å•é¡Œ"

# REPL æ¨¡å¼çµ„åˆ
> .file report.pdf image.png -- åˆ†æå ±å‘Šå’Œåœ–è¡¨çš„é—œè¯æ€§
```

**æ”¯æ´çš„æª”æ¡ˆæ ¼å¼:**
- æ–‡å­—: `.txt`, `.md`, `.log`, `.csv`
- ç¨‹å¼ç¢¼: `.py`, `.js`, `.rs`, `.go`, `.java` ç­‰
- æ–‡ä»¶: `.pdf`, `.docx`(éœ€å®‰è£å¤–éƒ¨å·¥å…·)
- åœ–ç‰‡: `.png`, `.jpg`, `.gif`, `.webp`(éœ€ Vision æ¨¡å‹)
- ç¶²é : HTML è‡ªå‹•è½‰ Markdown

---

### 5. è§’è‰²ç³»çµ± (Role System)

è‡ªè¨‚ AI çš„è¡Œç‚ºæ¨¡å¼å’Œå°ˆæ¥­é ˜åŸŸ,æå‡äº’å‹•æ•ˆç‡ã€‚

#### 5.1 å…§å»ºè§’è‰²

```bash
# åˆ—å‡ºæ‰€æœ‰è§’è‰²
aichat --list-roles

# ä½¿ç”¨è§’è‰²
aichat -r code "å¯¦ä½œå¿«é€Ÿæ’åº"
```

**é è¨­å…§å»ºè§’è‰²:**
- `%shell%` - Shell å‘½ä»¤ç”Ÿæˆå°ˆå®¶
- `%explain-shell%` - Shell å‘½ä»¤è§£é‡‹å°ˆå®¶
- `%code%` - ç¨‹å¼è¨­è¨ˆå°ˆå®¶

#### 5.2 è‡ªè¨‚è§’è‰²

å»ºç«‹è§’è‰²æª”æ¡ˆ: `~/.config/aichat/roles/translator.yaml`

```yaml
name: translator
description: å°ˆæ¥­è‹±ä¸­ç¿»è­¯

# ç³»çµ±æç¤ºè©
prompt: |
  ä½ æ˜¯ä¸€ä½å°ˆæ¥­çš„è‹±ä¸­ç¿»è­¯,æ“…é•·æŠ€è¡“æ–‡ä»¶ç¿»è­¯ã€‚

  ç¿»è­¯è¦å‰‡:
  - ä¿æŒå°ˆæ¥­è¡“èªçš„æº–ç¢ºæ€§
  - ä¿ç•™ç¨‹å¼ç¢¼å€å¡Šä¸ç¿»è­¯
  - èªæ°£è¦è‡ªç„¶æµæš¢
  - ä¿æŒåŸæ–‡çš„æ ¼å¼

# æ¨¡å‹è¨­å®š
model: gpt-4o
temperature: 0.3

# é€²éšåƒæ•¸
top_p: 0.9
```

**è§’è‰²é…ç½®é¸é …:**
```yaml
name: è§’è‰²åç¨±
description: è§’è‰²æè¿°
prompt: ç³»çµ±æç¤ºè©
model: ä½¿ç”¨çš„æ¨¡å‹
temperature: æº«åº¦(0-1)
top_p: Top-P åƒæ•¸
max_tokens: æœ€å¤§è¼¸å‡ºé•·åº¦
```

#### 5.3 ä½¿ç”¨å ´æ™¯

```bash
# ç¨‹å¼è¨­è¨ˆåŠ©æ‰‹
aichat -r code -f main.py "åŠ å…¥éŒ¯èª¤è™•ç†"

# ç¿»è­¯åŠ©æ‰‹
aichat -r translator "Translate: The quick brown fox"

# æ–‡æ¡ˆåŠ©æ‰‹
aichat -r copywriter "ç‚ºæ–°ç”¢å“å¯«è¡ŒéŠ·æ–‡æ¡ˆ"

# è³‡æ–™åˆ†æ
aichat -r analyst -f sales.csv "åˆ†æéŠ·å”®è¶¨å‹¢"
```

#### 5.4 è§’è‰²æœ€ä½³å¯¦è¸

1. **æ˜ç¢ºå®šç¾©è§’è‰²ç¯„åœ**
   ```yaml
   prompt: |
     ä½ æ˜¯ Python ç¨‹å¼è¨­è¨ˆå°ˆå®¶,å°ˆç²¾æ–¼:
     - å¾Œç«¯é–‹ç™¼(Django/Flask)
     - è³‡æ–™åˆ†æ(Pandas/NumPy)
     - æ•ˆèƒ½å„ªåŒ–
   ```

2. **æä¾›å…·é«”è¦å‰‡**
   ```yaml
   prompt: |
     ç¨‹å¼ç¢¼è¦ç¯„:
     - ä½¿ç”¨ Type Hints
     - éµå¾ª PEP 8
     - åŠ å…¥å®Œæ•´çš„ docstrings
   ```

3. **è¨­å®šé©ç•¶åƒæ•¸**
   ```yaml
   temperature: 0.2  # ç¨‹å¼ç¢¼ç”Ÿæˆç”¨ä½æº«åº¦
   temperature: 0.8  # å‰µæ„å¯«ä½œç”¨é«˜æº«åº¦
   ```

---

### 6. æœƒè©±ç³»çµ± (Session System)

ä¿æŒé€£çºŒå°è©±çš„ä¸Šä¸‹æ–‡,å¯¦ç¾é•·æœŸè¨˜æ†¶å’Œå°è©±ç®¡ç†ã€‚

#### 6.1 åŸºæœ¬æ“ä½œ

```bash
# å•Ÿå‹•æ–°æœƒè©±
aichat -s my-project

# ç¹¼çºŒç¾æœ‰æœƒè©±
aichat -s my-project "ç¹¼çºŒä¹‹å‰çš„è¨è«–"

# ç©ºæœƒè©±(æ¸…é™¤æ­·å²)
aichat -s my-project --empty-session

# ç¢ºä¿å„²å­˜æœƒè©±
aichat -s my-project --save-session
```

#### 6.2 æœƒè©±ç®¡ç†

```bash
# åˆ—å‡ºæ‰€æœ‰æœƒè©±
aichat --list-sessions

# REPL ä¸­ç®¡ç†
.session                    # é¡¯ç¤ºç•¶å‰æœƒè©±
.session new project-x      # å»ºç«‹æ–°æœƒè©±
.session save               # å„²å­˜ç•¶å‰æœƒè©±
.session load old-project   # è¼‰å…¥æœƒè©±
.session list               # åˆ—å‡ºæ‰€æœ‰æœƒè©±
.session delete temp        # åˆªé™¤æœƒè©±
```

#### 6.3 æœƒè©±é…ç½®

åœ¨ `config.yaml` ä¸­è¨­å®š:

```yaml
# æœƒè©±æŒä¹…åŒ–
save_session: true  # true: è‡ªå‹•å„²å­˜, false: ä¸å„²å­˜, null: è©¢å•

# å£“ç¸®é–¾å€¼(token æ•¸)
compress_threshold: 4000

# æ‘˜è¦æç¤ºè©
summarize_prompt: 'ç”¨ 200 å­—ä»¥å…§ç°¡æ½”ç¸½çµå°è©±å…§å®¹'

# æ‘˜è¦å‰ç¶´
summary_prompt: 'å°è©±æ­·å²æ‘˜è¦: '
```

#### 6.4 æœƒè©±å£“ç¸®

ç•¶å°è©±éé•·æ™‚,è‡ªå‹•å£“ç¸®ä»¥ç¯€çœ token:

```yaml
# é”åˆ° 4000 tokens æ™‚è§¸ç™¼å£“ç¸®
compress_threshold: 4000
```

**å£“ç¸®æµç¨‹:**
1. åµæ¸¬ token æ•¸è¶…éé–¾å€¼
2. å‘¼å« LLM ç”Ÿæˆå°è©±æ‘˜è¦
3. ä¿ç•™æ‘˜è¦ + æœ€è¿‘å°è©±
4. é‡‹æ”¾èˆŠçš„å°è©±è¨˜éŒ„

#### 6.5 ä½¿ç”¨å ´æ™¯

**å°ˆæ¡ˆé–‹ç™¼:**
```bash
# ç¬¬ä¸€å¤©
aichat -s webapp "é–‹å§‹è¨­è¨ˆä¸€å€‹ç¶²ç«™æ¶æ§‹"

# ç¬¬äºŒå¤©
aichat -s webapp "ç¹¼çºŒå¯¦ä½œå‰ç«¯éƒ¨åˆ†"

# ç¬¬ä¸‰å¤©
aichat -s webapp "å„ªåŒ–æ•ˆèƒ½å•é¡Œ"
```

**å­¸ç¿’èˆ‡ç ”ç©¶:**
```bash
# æ·±å…¥å­¸ç¿’æŸå€‹ä¸»é¡Œ
aichat -s rust-learning "å­¸ç¿’ Rust æ‰€æœ‰æ¬Šæ©Ÿåˆ¶"
# ... å¤šæ¬¡å°è©±å¾Œä»ä¿æŒä¸Šä¸‹æ–‡
```

**è‡¨æ™‚æœƒè©±:**
```bash
# ä½¿ç”¨é è¨­è‡¨æ™‚æœƒè©±
aichat -s "å¿«é€Ÿå•é¡Œ"
```

---

### 7. RAG (æª¢ç´¢å¢å¼·ç”Ÿæˆ)

æ•´åˆå¤–éƒ¨æ–‡ä»¶,è®“ AI åŸºæ–¼æ‚¨çš„æ–‡ä»¶åº«å›ç­”å•é¡Œã€‚

#### 7.1 å»ºç«‹ RAG

```bash
# å¾ç›®éŒ„å»ºç«‹ RAG
aichat --rag my-docs

# äº’å‹•å¼åŠ å…¥æ–‡ä»¶
> .rag add /path/to/docs
> .rag add https://docs.example.com

# æŒ‡å®šæª”æ¡ˆé¡å‹
> .rag add *.md *.txt
```

#### 7.2 ä½¿ç”¨ RAG

```bash
# å‘½ä»¤åˆ—æ¨¡å¼
aichat --rag my-docs "é€™å€‹å°ˆæ¡ˆå¦‚ä½•éƒ¨ç½²?"

# REPL æ¨¡å¼
> .rag my-docs
> è§£é‡‹é…ç½®æª”æ¡ˆçš„ä½œç”¨
```

#### 7.3 RAG é…ç½®

åœ¨ `config.yaml` ä¸­è¨­å®š:

```yaml
# Embedding æ¨¡å‹
rag_embedding_model: openai:text-embedding-3-small

# Reranker æ¨¡å‹(å¯é¸,æå‡ç²¾åº¦)
rag_reranker_model: cohere:rerank-english-v3.0

# æª¢ç´¢æ•¸é‡
rag_top_k: 5

# æ–‡ä»¶åˆ†å¡Šå¤§å°(å­—å…ƒæ•¸)
rag_chunk_size: 1000

# åˆ†å¡Šé‡ç–Š
rag_chunk_overlap: 200

# RAG æç¤ºè©æ¨¡æ¿
rag_template: |
  æ ¹æ“šä»¥ä¸‹ä¸Šä¸‹æ–‡å›ç­”å•é¡Œ:

  <context>
  __CONTEXT__
  </context>

  <rules>
  - å¦‚æœä¸çŸ¥é“ç­”æ¡ˆ,ç›´æ¥èªªä¸çŸ¥é“
  - å¦‚æœä¸ç¢ºå®š,è¦æ±‚æ¾„æ¸…
  - ç”¨èˆ‡å•é¡Œç›¸åŒçš„èªè¨€å›ç­”
  - ç›´æ¥å›ç­”,ä¸è¦ä½¿ç”¨ XML æ¨™ç±¤
  </rules>

  <user_query>
  __INPUT__
  </user_query>
```

#### 7.4 æ–‡ä»¶è¼‰å…¥å™¨

è‡ªè¨‚æ–‡ä»¶æ ¼å¼è™•ç†:

```yaml
document_loaders:
  # PDF æª”æ¡ˆ
  pdf: 'pdftotext $1 -'

  # Word æ–‡ä»¶
  docx: 'pandoc --to plain $1'

  # è‡ªè¨‚è¼‰å…¥å™¨
  custom: 'my-loader.sh $1 $2'
```

**å®‰è£å¤–éƒ¨å·¥å…·:**
```bash
# macOS
brew install poppler pandoc

# Ubuntu
apt install poppler-utils pandoc
```

#### 7.5 RAG ç®¡ç†

```bash
# åˆ—å‡ºæ‰€æœ‰ RAG
aichat --list-rags

# é‡å»º RAG(åŒæ­¥æ–‡ä»¶è®Šæ›´)
aichat --rag my-docs --rebuild-rag

# REPL å‘½ä»¤
.rag list                   # åˆ—å‡º RAG
.rag my-docs                # åˆ‡æ› RAG
.rag rebuild                # é‡å»ºç•¶å‰ RAG
.rag add new-file.pdf       # åŠ å…¥æ–‡ä»¶
```

#### 7.6 é€²éšåŠŸèƒ½

**ä½¿ç”¨ Reranker æå‡ç²¾åº¦:**
```yaml
rag_reranker_model: cohere:rerank-multilingual-v3.0
```

**è‡ªè¨‚åˆ†å¡Šç­–ç•¥:**
```yaml
rag_chunk_size: 1500        # è¼ƒå¤§çš„å¡Šä¿ç•™æ›´å¤šä¸Šä¸‹æ–‡
rag_chunk_overlap: 300      # è¼ƒå¤§çš„é‡ç–Šé¿å…æ–·å¥
```

**å¤šèªè¨€æ”¯æ´:**
- è‡ªå‹•åµæ¸¬æ–‡ä»¶èªè¨€
- æ”¯æ´ç¨‹å¼ç¢¼æ™ºæ…§åˆ†å¡Š
- ä¿æŒ Markdown çµæ§‹

#### 7.7 ä½¿ç”¨å ´æ™¯

**æŠ€è¡“æ–‡ä»¶å•ç­”:**
```bash
aichat --rag project-docs "å¦‚ä½•é…ç½®è³‡æ–™åº«é€£ç·š?"
```

**ç¨‹å¼ç¢¼åº«åˆ†æ:**
```bash
aichat --rag codebase "auth æ¨¡çµ„åœ¨å“ªè£¡å¯¦ä½œ?"
```

**ç ”ç©¶åŠ©æ‰‹:**
```bash
aichat --rag research-papers "ç¸½çµé—œæ–¼ XXX çš„æœ€æ–°ç ”ç©¶"
```

---

### 8. Function Calling (å‡½æ•¸å‘¼å«)

é€£æ¥å¤–éƒ¨å·¥å…·å’Œè³‡æ–™ä¾†æº,å¤§å¹…æ“´å±• AI èƒ½åŠ›ã€‚

#### 8.1 åŸºæœ¬æ¦‚å¿µ

Function Calling è®“ LLM èƒ½å¤ :
- å‘¼å«å¤–éƒ¨å·¥å…·
- å­˜å–å³æ™‚è³‡æ–™
- åŸ·è¡Œç³»çµ±æ“ä½œ
- æ•´åˆç¬¬ä¸‰æ–¹æœå‹™

#### 8.2 é…ç½® Function Calling

åœ¨ `config.yaml` ä¸­å•Ÿç”¨:

```yaml
# å…¨åŸŸå•Ÿç”¨
function_calling: true

# å·¥å…·æ˜ å°„(åˆ¥å)
mapping_tools:
  fs: 'fs_cat,fs_ls,fs_mkdir,fs_rm,fs_write'
  web: 'web_search,web_fetch'

# é è¨­ä½¿ç”¨çš„å·¥å…·
use_tools: 'fs,web'
```

#### 8.3 å…§å»ºå·¥å…·ç¯„ä¾‹

åƒè€ƒ [llm-functions](https://github.com/sigoden/llm-functions) å°ˆæ¡ˆ:

**æª”æ¡ˆç³»çµ±å·¥å…·:**
- `fs_cat` - è®€å–æª”æ¡ˆå…§å®¹
- `fs_ls` - åˆ—å‡ºç›®éŒ„
- `fs_mkdir` - å»ºç«‹ç›®éŒ„
- `fs_rm` - åˆªé™¤æª”æ¡ˆ
- `fs_write` - å¯«å…¥æª”æ¡ˆ

**ç¶²è·¯å·¥å…·:**
- `web_search` - ç¶²è·¯æœå°‹
- `web_fetch` - æŠ“å–ç¶²é 
- `web_scrape` - ç¶²é çˆ¬èŸ²

**ç³»çµ±å·¥å…·:**
- `execute_command` - åŸ·è¡Œç³»çµ±å‘½ä»¤
- `get_env` - å–å¾—ç’°å¢ƒè®Šæ•¸

#### 8.4 MCP (Model Context Protocol)

æ”¯æ´ MCP å”è­°æ•´åˆå¤–éƒ¨æœå‹™:

```yaml
# MCP ä¼ºæœå™¨é…ç½®
mcp_servers:
  - name: database
    command: mcp-database-server
    args: ["--db", "postgres://..."]

  - name: filesystem
    command: mcp-fs-server
    args: ["--root", "/workspace"]
```

#### 8.5 ä½¿ç”¨ç¯„ä¾‹

**è‡ªå‹•æœå°‹ä¸¦æ•´ç†è³‡è¨Š:**
```bash
aichat --use-tools web "æœå°‹æœ€æ–°çš„ Rust 1.75 æ›´æ–°å…§å®¹ä¸¦ç¸½çµ"
```

**æª”æ¡ˆæ“ä½œ:**
```bash
aichat --use-tools fs "æ‰¾å‡ºå°ˆæ¡ˆä¸­æ‰€æœ‰ TODO è¨»è§£ä¸¦æ•´ç†æˆæ¸…å–®"
```

**å¤šå·¥å…·å”ä½œ:**
```bash
aichat --use-tools fs,web "åˆ†ææœ¬åœ°æ—¥èªŒæª”æ¡ˆ,æœå°‹éŒ¯èª¤åŸå› ,æä¾›è§£æ±ºæ–¹æ¡ˆ"
```

#### 8.6 è‡ªè¨‚å·¥å…·

å»ºç«‹å·¥å…·å®šç¾©æª”: `~/.config/aichat/functions/tools.json`

```json
[
  {
    "name": "get_weather",
    "description": "å–å¾—æŒ‡å®šåŸå¸‚çš„å¤©æ°£è³‡è¨Š",
    "parameters": {
      "type": "object",
      "properties": {
        "city": {
          "type": "string",
          "description": "åŸå¸‚åç¨±"
        }
      },
      "required": ["city"]
    },
    "command": "curl",
    "args": ["https://api.weather.com?city={{city}}"]
  }
]
```

---

### 9. AI Agents

AI Agent æ˜¯æŒ‡ä»¤ã€å·¥å…·å’Œæ–‡ä»¶çš„çµ„åˆ,å¯åŸ·è¡Œè¤‡é›œçš„è‡ªå‹•åŒ–ä»»å‹™ã€‚

#### 9.1 Agent æ¦‚å¿µ

**Agent = æŒ‡ä»¤(Prompt) + å·¥å…·(Tools) + æ–‡ä»¶(RAG)**

é¡ä¼¼ OpenAI GPTs,ä½†åœ¨å‘½ä»¤åˆ—ä¸­é‹è¡Œã€‚

#### 9.2 å»ºç«‹ Agent

å»ºç«‹ Agent ç›®éŒ„çµæ§‹:
```
~/.config/aichat/agents/
â””â”€â”€ my-agent/
    â”œâ”€â”€ config.yaml          # Agent é…ç½®
    â”œâ”€â”€ instructions.md      # æŒ‡ä»¤èªªæ˜
    â””â”€â”€ documents/           # æ–‡ä»¶åº«(å¯é¸)
```

**config.yaml:**
```yaml
# Agent åç¨±
name: code-reviewer

# ä½¿ç”¨çš„æ¨¡å‹
model: claude:claude-3-5-sonnet

# æº«åº¦
temperature: 0.3

# å¯ç”¨å·¥å…·
use_tools: 'fs,git'

# æœƒè©±è¨­å®š
agent_prelude: temp

# æŒ‡ä»¤(æˆ–ä½¿ç”¨ instructions.md)
instructions: |
  ä½ æ˜¯å°ˆæ¥­çš„ç¨‹å¼ç¢¼å¯©æŸ¥å°ˆå®¶ã€‚

  å¯©æŸ¥é‡é»:
  1. ç¨‹å¼ç¢¼å“è³ªå’Œå¯è®€æ€§
  2. æ½›åœ¨çš„ bug å’Œå®‰å…¨å•é¡Œ
  3. æ•ˆèƒ½å„ªåŒ–å»ºè­°
  4. æœ€ä½³å¯¦è¸éµå¾ª

  è¼¸å‡ºæ ¼å¼:
  - ç¸½é«”è©•åˆ†(1-10)
  - ä¸»è¦å•é¡Œåˆ—è¡¨
  - æ”¹é€²å»ºè­°
  - å„ªé»ç¸½çµ

# è®Šæ•¸é è¨­å€¼
variables:
  language: python
  style_guide: pep8
```

**instructions.md:**
```markdown
# Code Reviewer Agent

ä½ æ˜¯å°ˆæ¥­çš„ {{language}} ç¨‹å¼ç¢¼å¯©æŸ¥å°ˆå®¶ã€‚

## å¯©æŸ¥æ¨™æº–
- éµå¾ª {{style_guide}} è¦ç¯„
- é‡è¦–ç¨‹å¼ç¢¼å®‰å…¨æ€§
- é—œæ³¨æ•ˆèƒ½å•é¡Œ

## å¯©æŸ¥æµç¨‹
1. ç†è§£ç¨‹å¼ç¢¼æ„åœ–
2. æª¢æŸ¥æ½›åœ¨å•é¡Œ
3. æä¾›æ”¹é€²å»ºè­°
4. ç¸½çµå„ªç¼ºé»
```

#### 9.3 ä½¿ç”¨ Agent

```bash
# åˆ—å‡ºæ‰€æœ‰ Agent
aichat --list-agents

# å•Ÿå‹• Agent
aichat -a code-reviewer

# æŒ‡å®šè®Šæ•¸
aichat -a code-reviewer --agent-variable language rust

# è¼‰å…¥æª”æ¡ˆ
aichat -a code-reviewer -f main.rs "å¯©æŸ¥é€™å€‹æª”æ¡ˆ"
```

#### 9.4 Agent ç¯„ä¾‹

**ç ”ç©¶åŠ©æ‰‹:**
```yaml
name: researcher
model: gpt-4o
use_tools: web_search,web_fetch
instructions: |
  ä½ æ˜¯ç ”ç©¶åŠ©æ‰‹,æ“…é•·:
  - æœé›†è³‡è¨Š
  - åˆ†æè³‡æ–™
  - æ’°å¯«å ±å‘Š

  å·¥ä½œæµç¨‹:
  1. æœå°‹ç›¸é—œè³‡æ–™
  2. é©—è­‰è³‡è¨Šä¾†æº
  3. æ•´ç†æˆçµæ§‹åŒ–å ±å‘Š
```

**è³‡æ–™åˆ†æå¸«:**
```yaml
name: analyst
model: gpt-4o
use_tools: fs,python
instructions: |
  ä½ æ˜¯è³‡æ–™åˆ†æå°ˆå®¶ã€‚

  åˆ†ææ­¥é©Ÿ:
  1. è¼‰å…¥ä¸¦æª¢æŸ¥è³‡æ–™
  2. è³‡æ–™æ¸…æ´—å’Œé è™•ç†
  3. çµ±è¨ˆåˆ†æ
  4. è¦–è¦ºåŒ–å‘ˆç¾
  5. æ’°å¯«åˆ†æå ±å‘Š
```

**æ–‡ä»¶åŠ©æ‰‹:**
```yaml
name: doc-writer
model: claude:claude-3-5-sonnet
use_tools: fs
instructions: |
  ä½ æ˜¯æŠ€è¡“æ–‡ä»¶æ’°å¯«å°ˆå®¶ã€‚

  æ–‡ä»¶æ¨™æº–:
  - æ¸…æ™°çš„çµæ§‹
  - å®Œæ•´çš„ç¯„ä¾‹
  - å¯¦ç”¨çš„èªªæ˜
  - é©ç•¶çš„åœ–è¡¨
```

#### 9.5 Agent æœ€ä½³å¯¦è¸

1. **æ˜ç¢ºå®šç¾©ä»»å‹™ç¯„åœ**
2. **æä¾›è©³ç´°çš„æŒ‡ä»¤**
3. **é¸æ“‡åˆé©çš„å·¥å…·çµ„åˆ**
4. **ä½¿ç”¨ RAG æä¾›èƒŒæ™¯çŸ¥è­˜**
5. **è¨­å®šé©ç•¶çš„æ¨¡å‹å’Œåƒæ•¸**

---

### 10. å·¨é›†ç³»çµ± (Macro System)

å°‡å¸¸ç”¨çš„å‘½ä»¤åºåˆ—çµ„åˆæˆå¯é‡è¤‡ä½¿ç”¨çš„å·¨é›†ã€‚

#### 10.1 å»ºç«‹å·¨é›†

å·¨é›†æª”æ¡ˆä½ç½®: `~/.config/aichat/macros/`

**ç¯„ä¾‹: translate.macro**
```bash
# ç¿»è­¯å·¨é›†
.role translator
.file $1
ç¿»è­¯æˆç¹é«”ä¸­æ–‡
```

**ç¯„ä¾‹: review.macro**
```bash
# ç¨‹å¼ç¢¼å¯©æŸ¥å·¨é›†
.agent code-reviewer
.file $1
å¯©æŸ¥é€™æ®µç¨‹å¼ç¢¼,é‡é»é—œæ³¨:
1. å®‰å…¨æ€§
2. æ•ˆèƒ½
3. å¯ç¶­è­·æ€§
```

#### 10.2 ä½¿ç”¨å·¨é›†

```bash
# åŸ·è¡Œå·¨é›†
aichat --macro translate document.txt

# å¸¶åƒæ•¸
aichat --macro review src/main.rs

# åˆ—å‡ºæ‰€æœ‰å·¨é›†
aichat --list-macros
```

#### 10.3 å·¨é›†è®Šæ•¸

```bash
# $1, $2, $3... ä»£è¡¨ä½ç½®åƒæ•¸
# $@ ä»£è¡¨æ‰€æœ‰åƒæ•¸

# ç¯„ä¾‹
.role code
.file $1 $2
é‡æ§‹é€™äº›æª”æ¡ˆ,ç›®æ¨™: $3
```

ä½¿ç”¨:
```bash
aichat --macro refactor main.py utils.py "æå‡å¯è®€æ€§"
```

#### 10.4 å¯¦ç”¨å·¨é›†ç¯„ä¾‹

**æ¯æ—¥ç¸½çµ:**
```bash
# daily-summary.macro
.session daily
.file '`git log --since="1 day ago" --pretty=format:"%s"`'
ç¸½çµä»Šå¤©çš„å·¥ä½œå…§å®¹
```

**éŒ¯èª¤è¨ºæ–·:**
```bash
# diagnose.macro
.role troubleshooter
.file $1
.file '`uname -a`'
åˆ†æéŒ¯èª¤æ—¥èªŒä¸¦æä¾›è§£æ±ºæ–¹æ¡ˆ
```

**æ–‡ä»¶ç”Ÿæˆ:**
```bash
# doc-gen.macro
.role doc-writer
.file $1
ç‚ºé€™å€‹æ¨¡çµ„ç”Ÿæˆå®Œæ•´çš„ API æ–‡ä»¶
```

---

### 11. æ¸²æŸ“èˆ‡é¡¯ç¤º

#### 11.1 èªæ³•é«˜äº®

è‡ªå‹•é«˜äº®ç¨‹å¼ç¢¼å€å¡Š:

```yaml
# å•Ÿç”¨é«˜äº®
highlight: true

# äº®/æš—ä¸»é¡Œ
light_theme: false
```

æ”¯æ´çš„èªè¨€:
- Python, JavaScript, TypeScript, Rust, Go, Java
- C, C++, C#, Ruby, PHP, Swift, Kotlin
- HTML, CSS, SQL, Shell, Markdown
- é‚„æœ‰æ›´å¤š...

#### 11.2 è‡ªè¨‚ä¸»é¡Œ

å»ºç«‹ä¸»é¡Œæª”æ¡ˆ: `~/.config/aichat/themes/my-theme.yaml`

```yaml
# æ·±è‰²ä¸»é¡Œç¯„ä¾‹
name: my-dark-theme
light: false

colors:
  background: "#1e1e1e"
  foreground: "#d4d4d4"

  # èªæ³•å…ƒç´ 
  keyword: "#569cd6"
  string: "#ce9178"
  comment: "#6a9955"
  function: "#dcdcaa"
  variable: "#9cdcfe"

  # UI å…ƒç´ 
  prompt: "#00ff00"
  error: "#f44747"
  warning: "#ff8800"
```

ä½¿ç”¨ä¸»é¡Œ:
```yaml
# config.yaml
theme: my-dark-theme
```

#### 11.3 æ–‡å­—æ›è¡Œ

```yaml
# ä¸æ›è¡Œ
wrap: no

# è‡ªå‹•æ›è¡Œ
wrap: auto

# å›ºå®šå¯¬åº¦
wrap: 80
```

#### 11.4 è‡ªè¨‚ REPL æç¤ºç¬¦

```yaml
# å·¦å´æç¤ºç¬¦
left_prompt: |
  {color.green}{?session {session}>}{role}{color.cyan}>{color.reset}

# å³å´æç¤ºç¬¦
right_prompt: |
  {color.purple}{consume_tokens}({consume_percent}%){color.reset}
```

**å¯ç”¨è®Šæ•¸:**
- `{role}` - ç•¶å‰è§’è‰²
- `{session}` - ç•¶å‰æœƒè©±
- `{agent}` - ç•¶å‰ Agent
- `{rag}` - ç•¶å‰ RAG
- `{model}` - ç•¶å‰æ¨¡å‹
- `{consume_tokens}` - å·²ä½¿ç”¨ tokens
- `{consume_percent}` - ä½¿ç”¨ç™¾åˆ†æ¯”

**é¡è‰²:**
- `{color.red}`, `{color.green}`, `{color.blue}`
- `{color.cyan}`, `{color.yellow}`, `{color.purple}`
- `{color.reset}` - é‡è¨­é¡è‰²

---

### 12. å…¶ä»–åŠŸèƒ½

#### 12.1 æ¨¡å‹ç®¡ç†

```bash
# åˆ—å‡ºæ‰€æœ‰å¯ç”¨æ¨¡å‹
aichat --list-models

# åŒæ­¥æ¨¡å‹å®šç¾©
aichat --sync-models

# ä½¿ç”¨ç‰¹å®šæ¨¡å‹
aichat -m gpt-4o "ä½ å¥½"
```

**æ¨¡å‹é¸æ“‡èªæ³•:**
```bash
# æä¾›å•†:æ¨¡å‹åç¨±
-m openai:gpt-4o
-m claude:claude-3-5-sonnet
-m gemini:gemini-pro

# ç°¡çŸ­å½¢å¼(éœ€è¦å”¯ä¸€)
-m gpt-4o
-m claude-3-5-sonnet
```

#### 12.2 ä¸²æµæ§åˆ¶

```yaml
# é è¨­å•Ÿç”¨ä¸²æµ
stream: true
```

```bash
# é—œé–‰ä¸²æµ
aichat -S "å•é¡Œ"
aichat --no-stream "å•é¡Œ"
```

#### 12.3 è¨Šæ¯æŒä¹…åŒ–

```yaml
# å„²å­˜æ‰€æœ‰è¨Šæ¯
save: true
```

è¨Šæ¯å„²å­˜ä½ç½®: `~/.config/aichat/messages/`

#### 12.4 ç·¨è¼¯å™¨æ•´åˆ

```yaml
# æŒ‡å®šç·¨è¼¯å™¨
editor: vim

# æˆ–ä½¿ç”¨ç’°å¢ƒè®Šæ•¸
# export EDITOR=code
```

åœ¨ REPL ä¸­æŒ‰ `Ctrl+O` é–‹å•Ÿç·¨è¼¯å™¨ã€‚

#### 12.5 å‰ªè²¼ç°¿æ•´åˆ

```bash
# REPL å‘½ä»¤
.copy              # è¤‡è£½æœ€å¾Œçš„å›è¦†
```

#### 12.6 ä»£ç†ä¼ºæœå™¨

```yaml
clients:
  - type: openai
    api_key: xxx
    extra:
      proxy: socks5://127.0.0.1:1080
      connect_timeout: 10
```

#### 12.7 æ—¥èªŒè¨˜éŒ„

```yaml
# å„²å­˜ Shell åŸ·è¡Œæ­·å²
save_shell_history: true
```

æ—¥èªŒä½ç½®: `~/.config/aichat/history`

#### 12.8 ä¹¾é‹è¡Œæ¨¡å¼

```bash
# é¡¯ç¤ºè«‹æ±‚ä½†ä¸ç™¼é€
aichat --dry-run "æ¸¬è©¦æç¤ºè©"
```

ç”¨é€”:
- æ¸¬è©¦æç¤ºè©
- æª¢æŸ¥ token ä½¿ç”¨
- é™¤éŒ¯é…ç½®

---

## å®‰è£æ–¹å¼

### å¥—ä»¶ç®¡ç†å™¨

```bash
# Rust é–‹ç™¼è€…
cargo install aichat

# Homebrew (macOS/Linux)
brew install aichat

# Arch Linux
pacman -S aichat

# Windows Scoop
scoop install aichat

# Android Termux
pkg install aichat
```

### é ç·¨è­¯äºŒé€²ä½

å¾ [GitHub Releases](https://github.com/sigoden/aichat/releases) ä¸‹è¼‰é©åˆæ‚¨ç³»çµ±çš„ç‰ˆæœ¬ã€‚

---

## é…ç½®æª”æ¡ˆ

### ä¸»é…ç½®æª”æ¡ˆ

ä½ç½®: `~/.config/aichat/config.yaml`

åƒè€ƒ `config.example.yaml` å»ºç«‹æ‚¨çš„é…ç½®ã€‚

### é…ç½®çµæ§‹

```
~/.config/aichat/
â”œâ”€â”€ config.yaml              # ä¸»é…ç½®
â”œâ”€â”€ roles/                   # è§’è‰²å®šç¾©
â”‚   â”œâ”€â”€ coder.yaml
â”‚   â””â”€â”€ translator.yaml
â”œâ”€â”€ agents/                  # Agent å®šç¾©
â”‚   â”œâ”€â”€ researcher/
â”‚   â””â”€â”€ analyst/
â”œâ”€â”€ macros/                  # å·¨é›†æª”æ¡ˆ
â”‚   â”œâ”€â”€ translate.macro
â”‚   â””â”€â”€ review.macro
â”œâ”€â”€ functions/               # å‡½æ•¸å®šç¾©
â”‚   â””â”€â”€ tools.json
â”œâ”€â”€ themes/                  # è‡ªè¨‚ä¸»é¡Œ
â”‚   â””â”€â”€ my-theme.yaml
â””â”€â”€ sessions/                # æœƒè©±å„²å­˜
    â”œâ”€â”€ project-a.yaml
    â””â”€â”€ project-b.yaml
```

### ç’°å¢ƒè®Šæ•¸

```bash
# é…ç½®ç›®éŒ„
export AICHAT_CONFIG_DIR=~/.config/aichat

# API Keys
export OPENAI_API_KEY=sk-xxx
export ANTHROPIC_API_KEY=sk-ant-xxx
export GEMINI_API_KEY=xxx

# ä»£ç†
export HTTPS_PROXY=http://127.0.0.1:7890

# ä¸»é¡Œ
export AICHAT_LIGHT_THEME=true
```

---

## ä½¿ç”¨å ´æ™¯ç¯„ä¾‹

### 1. æ—¥å¸¸é–‹ç™¼

```bash
# å¿«é€ŸæŸ¥è©¢
aichat "Rust ä¸­å¦‚ä½•è™•ç†éŒ¯èª¤?"

# ç¨‹å¼ç¢¼å¯©æŸ¥
aichat -f main.rs "é€™æ®µç¨‹å¼ç¢¼æœ‰ä»€éº¼å•é¡Œ?"

# ç”Ÿæˆæ¸¬è©¦
aichat -r code -f src/lib.rs "ç‚ºé€™å€‹æ¨¡çµ„å¯«å–®å…ƒæ¸¬è©¦"

# Git æ“ä½œ
aichat -e "æäº¤æ‰€æœ‰è®Šæ›´ä¸¦æ¨é€"
```

### 2. å­¸ç¿’æ–°æŠ€è¡“

```bash
# é–‹å•Ÿå­¸ç¿’æœƒè©±
aichat -s rust-learning

# æŒçºŒå­¸ç¿’
> è§£é‡‹ Rust çš„æ‰€æœ‰æ¬Šæ©Ÿåˆ¶
> çµ¦æˆ‘ä¸€å€‹ç¯„ä¾‹
> é€™å’Œ C++ çš„ RAII æœ‰ä»€éº¼ä¸åŒ?
> ...
```

### 3. æ–‡ä»¶è™•ç†

```bash
# å»ºç«‹æ–‡ä»¶åº«
aichat --rag project-docs
> .rag add docs/ README.md

# å•ç­”
aichat --rag project-docs "éƒ¨ç½²æµç¨‹æ˜¯ä»€éº¼?"
```

### 4. è‡ªå‹•åŒ–ä»»å‹™

```bash
# ä½¿ç”¨ Agent
aichat -a data-processor -f data.csv "æ¸…æ´—è³‡æ–™ä¸¦ç”Ÿæˆå ±å‘Š"

# ä½¿ç”¨å·¨é›†
aichat --macro daily-report
```

### 5. å¤šæ¨¡å‹æ¯”è¼ƒ

```bash
# å•Ÿå‹• Arena
aichat --serve
# ç€è¦½å™¨é–‹å•Ÿ http://localhost:8000/arena?num=3
```

---

## é€²éšæŠ€å·§

### 1. ç®¡é“æ“ä½œ

```bash
# éŒ¯èª¤è¨ºæ–·ç®¡é“
tail -f app.log | grep ERROR | aichat "åˆ†æä¸¦æä¾›è§£æ±ºæ–¹æ¡ˆ"

# ç¨‹å¼ç¢¼çµ±è¨ˆ
find . -name "*.rs" | xargs cat | aichat "çµ±è¨ˆç¨‹å¼ç¢¼è¡Œæ•¸å’Œè¤‡é›œåº¦"
```

### 2. è…³æœ¬æ•´åˆ

```bash
#!/bin/bash
# auto-commit.sh

diff=$(git diff)
if [ -n "$diff" ]; then
    message=$(echo "$diff" | aichat "ç”Ÿæˆç°¡æ½”çš„ commit message")
    git add .
    git commit -m "$message"
fi
```

### 3. å·¥ä½œæµç¨‹è‡ªå‹•åŒ–

```bash
# .bashrc æˆ– .zshrc
alias explain='aichat -r explain-shell'
alias commit='git diff | aichat "ç”Ÿæˆ commit message"'
alias review='aichat -a code-reviewer -f'
```

### 4. çµ„åˆä½¿ç”¨

```bash
# RAG + Agent + Session
aichat \
  -s my-project \
  -a developer \
  --rag project-docs \
  -f src/ \
  "æ ¹æ“šæ–‡ä»¶é‡æ§‹é€™å€‹æ¨¡çµ„"
```

---

## æ•ˆèƒ½å„ªåŒ–

### 1. æ¨¡å‹é¸æ“‡

```yaml
# å¿«é€Ÿå›æ‡‰
model: gpt-4o-mini

# å¹³è¡¡æ•ˆèƒ½
model: gpt-4o

# æœ€ä½³å“è³ª
model: claude:claude-3-5-sonnet
```

### 2. Token å„ªåŒ–

```yaml
# å•Ÿç”¨å£“ç¸®
compress_threshold: 4000

# é™åˆ¶è¼¸å‡ºé•·åº¦
max_tokens: 2000
```

### 3. æœ¬åœ°æ¨¡å‹

```yaml
# ä½¿ç”¨ Ollama
clients:
  - type: openai-compatible
    name: ollama
    api_base: http://localhost:11434/v1

model: ollama:llama3.1
```

---

## å®‰å…¨æ€§

### 1. API Key ç®¡ç†

```bash
# ä½¿ç”¨ç’°å¢ƒè®Šæ•¸
export OPENAI_API_KEY=sk-xxx

# æˆ–ä½¿ç”¨é…ç½®æª”æ¡ˆæ¬Šé™
chmod 600 ~/.config/aichat/config.yaml
```

### 2. æ•æ„Ÿè³‡æ–™

```yaml
# ä¸å„²å­˜æ•æ„Ÿæœƒè©±
save_session: false

# æˆ–ä½¿ç”¨è‡¨æ™‚æœƒè©±
aichat -s temp "è™•ç†æ•æ„Ÿè³‡æ–™"
```

### 3. å·¥å…·æ¬Šé™

```yaml
# é™åˆ¶å·¥å…·ä½¿ç”¨
use_tools: 'fs_read,web_search'  # åªå…è¨±è®€å–å’Œæœå°‹
```

---

## ç–‘é›£æ’è§£

### å¸¸è¦‹å•é¡Œ

1. **ç„¡æ³•é€£ç·š API**
   ```bash
   # æª¢æŸ¥ä»£ç†è¨­å®š
   export HTTPS_PROXY=http://127.0.0.1:7890

   # æ¸¬è©¦é€£ç·š
   aichat --info
   ```

2. **Token è¶…é™**
   ```yaml
   # å•Ÿç”¨å£“ç¸®
   compress_threshold: 3000

   # æˆ–ä½¿ç”¨æ›´å¤§ä¸Šä¸‹æ–‡çš„æ¨¡å‹
   model: claude:claude-3-5-sonnet  # 200K context
   ```

3. **ç·¨ç¢¼å•é¡Œ**
   ```bash
   # è¨­å®š locale
   export LANG=zh_TW.UTF-8
   ```

4. **RAG å»ºç«‹å¤±æ•—**
   ```bash
   # æª¢æŸ¥æ–‡ä»¶è¼‰å…¥å™¨
   pdftotext -v
   pandoc --version
   ```

---

## ç¤¾ç¾¤èˆ‡æ”¯æ´

- **GitHub**: https://github.com/sigoden/aichat
- **Discord**: https://discord.gg/mr3ZZUB9hG
- **Wiki**: https://github.com/sigoden/aichat/wiki
- **å•é¡Œå›å ±**: https://github.com/sigoden/aichat/issues

---

## æˆæ¬Š

æœ¬å°ˆæ¡ˆæ¡ç”¨é›™æˆæ¬Š:
- MIT License
- Apache License 2.0

æ‚¨å¯ä»¥é¸æ“‡å…¶ä¸­ä¸€ç¨®æˆæ¬Šæ–¹å¼ä½¿ç”¨ã€‚

---

## ç¸½çµ

AIChat æ˜¯ä¸€å€‹åŠŸèƒ½è±å¯Œã€è¨­è¨ˆå„ªé›…çš„ LLM CLI å·¥å…·,æä¾›:

- âœ… çµ±ä¸€çš„å¤šæä¾›å•†ä»‹é¢
- âœ… éˆæ´»çš„å·¥ä½œæ¨¡å¼(CMD/REPL/Serve)
- âœ… å¼·å¤§çš„æœƒè©±å’Œè§’è‰²ç³»çµ±
- âœ… RAG æª¢ç´¢å¢å¼·
- âœ… Function Calling å·¥å…·æ•´åˆ
- âœ… AI Agents è‡ªå‹•åŒ–
- âœ… è±å¯Œçš„è‡ªè¨‚é¸é …

ç„¡è«–æ‚¨æ˜¯é–‹ç™¼è€…ã€ç ”ç©¶äººå“¡é‚„æ˜¯æ™®é€šä½¿ç”¨è€…,AIChat éƒ½èƒ½å¤§å¹…æå‡æ‚¨èˆ‡ AI äº’å‹•çš„æ•ˆç‡ã€‚

ç«‹å³é–‹å§‹ä½¿ç”¨,é«”é©—å‘½ä»¤åˆ—çš„ AI å¼·å¤§åŠŸèƒ½!
